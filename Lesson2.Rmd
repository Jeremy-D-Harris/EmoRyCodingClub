---
Title: "Lesson 2"
header-includes: \usepackage{float}
always_allow_html: yes
output:
  html_document:
    code_folding: hide
params:
  lesson: !r paste0("Lesson ",2)
  title: "Lesson 2: Reading data, setting working directories, and plotting facets"  
---


```{r, setup, echo = FALSE, cache = FALSE, include = FALSE}
options(width=100)
knitr::opts_chunk$set(
  eval = FALSE, # run all code
  echo = TRUE, # show code chunks in output 
  tidy = TRUE, # make output as tidy
  message = FALSE,  # mask all messages
  warning = FALSE, # mask all warnings 
  comment = "",
  tidy.opts=list(width.cutoff=100), # set width of code chunks in output
  size="small" # set code chunk size
  )
```
\

<!-- install packages -->
```{r, load packages, eval=T, include=T, cache=F, message=F, warning=F, results='hide',echo=F}
packages <- c("ggplot2","ggthemes","dplyr","tidyverse","zoo","RColorBrewer","viridis","plyr")   
if (require(packages)) {
    install.packages(packages,dependencies = T)
    require(packages)
    # load tvthemes
    devtools::install_github("Ryo-N7/tvthemes")
}
lapply(packages,library,character.only=T)
```

<!-- ____________________________________________________________________________ -->
<!-- ____________________________________________________________________________ -->
<!-- ____________________________________________________________________________ -->
<!-- start body -->

# `r params$title`    
\  

Functions for `r params$lesson`    
```{r,eval=T, echo=F}
require(readr)
readLines("https://raw.githubusercontent.com/darwinanddavis/EmoRyCodingClub/master/functions_lesson2.txt")
```
\    

Packages for `r params$lesson`      
```{r,eval=T, echo=F}
require(readr)
readLines("https://raw.githubusercontent.com/darwinanddavis/EmoRyCodingClub/master/packages_lesson2.txt")
```
\    

# Agenda

We'll be using [Ch 3 Data visualisation in `R` for Data Science](https://r4ds.had.co.nz/data-visualisation.html).  
Section 3.1.1.     

* Do first problem set
* Read in data file  
* Set working directory `here`  
* Facets  


\  

# Do First problem set  

Before each new session, we'll do a quick recap, called a Do First. These will only use functions we've previously covered, so if you're unsure or can't remember, just check the code from the previous session.    
\    

Recreate the below plot using the smaller NYC Airbnb dataset (`nyc` from Lesson 1). There are four aesthetics to change and the plot uses `theme_solarized`.  
_Hint_: Use the help `?` function if something isn't clear.  
```{r, echo=T}


# You didn't think we'd make it this easy, did you?


```


```{r, echo=F, eval=T, out.width="100%"}
require(ggplot2)
require(dplyr)
require(ggthemes)

# smaller csv file (16 cols)
url <- "http://data.insideairbnb.com/united-states/ny/new-york-city/2019-06-02/visualisations/listings.csv"

nyc <-  read_csv(url)
nyc <- nyc[nyc$id < 1000000,] # get smaller subet of data

ggplot(data=nyc) +
  geom_point(mapping = aes(x=minimum_nights, y=number_of_reviews), colour = "orange", shape = 15, size = 2, alpha = 0.4) +
  theme_solarized()
```
\    

# Some useful shortkeys for making `R` life easier    

`TAB` = autofill rest of function/global variable  
`CTRL + ENTER` = run code    
`ALT + -` = insert assign operator `<-`  
`CTRL + SHIFT + M` = insert pipe `%>%`        
**Run `ALT + SHIFT + K`  for [all available shortkeys](https://support.rstudio.com/hc/en-us/articles/200711853-Keyboard-Shortcuts)**          
\    

# Load packages with `pacman`  
```{r}
install.packages("pacman")
require(pacman)
```

Type in the packages you want to install into the p_load function.  
_Note: the below two arguments are the same_
```{r}
p_load(dplyr,ggplot2) # your packages  
pacman::p_load(dplyr,ggplot2) # this is the same as above, just the tidyverse way of doing it: 'package::function(argument1,argument2,argument3)'
```

# Plotting facets    
`facet_wrap` and `facet_grid`  
Facets add a third variable to a plot.   
  * The facet function takes a formula as an argument, which is just a data structure, denoted by a tilde **~**  

`facet_wrap`    
```{r,eval=T}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_wrap(~ class, nrow = 2) +
  theme_classic()

```

`facet_grid`  
```{r, eval=T}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) + 
  facet_grid(drv ~ cyl) +
  theme_bw()
```


# Exercise 1  
Try plotting facets using the smaller Airbnb data.  
 * What happens when you use a continuous variable on a `facet_wrap`?  


